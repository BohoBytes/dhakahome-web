{{define "content"}}
<div class="min-h-screen bg-white">
  <!-- Header -->
  {{template "partials/header.html" .}}

  <!-- Search band -->
  <section class="relative isolate overflow-hidden mt-6 mb-6">
    <div class="absolute inset-0 bg-[url('/assets/images/backgrounds/search-hero-bg.png')] bg-cover bg-center opacity-80 -z-10"></div>
    <div class="absolute inset-0 bg-white/55 -z-10"></div>
    <div class="max-w-[1100px] mx-auto px-4 py-7">
      {{template "partials/search-box.html" .}}
    </div>
  </section>

  <!-- Property Details Section -->
  <section class="max-w-[85rem] mx-auto px-4 pb-16">
    <div class="bg-[#f1f1f1] rounded-[20px] shadow-[0_4px_4px_rgba(0,0,0,0.15)] p-6 md:p-10">
      <!-- Header with Back Button, Title, and Price -->
      <div class="flex flex-col gap-4 md:flex-row md:items-start md:justify-between mb-4">
        <div class="flex items-start gap-3">
          <button onclick="history.back()" class="w-[40px] h-[40px] flex items-center justify-center rounded-full hover:bg-[#e8e8e8] transition flex-shrink-0 mt-1">
            <svg width="19" height="33" viewBox="0 0 19 33" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M16.5 3L3 16.5L16.5 30" stroke="#383838" stroke-width="5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
          <div>
            <h1 class="text-[32px] md:text-[45px] font-normal leading-[54px] text-[#414141]" style="font-family: 'Poppins', sans-serif;">
              {{.P.Title}}
            </h1>
          </div>
        </div>
        <div class="text-[32px] md:text-[45px] font-normal leading-[54px] text-[#414141]" style="font-family: 'Poppins', sans-serif;">
          {{.P.Currency}}{{formatPrice .P.Price}}
        </div>
      </div>

      <!-- Badges -->
      <div class="flex flex-wrap gap-2 mb-6">
        {{range .P.Badges}}
        <span class="inline-flex items-center px-4 py-2 text-[18px] font-normal text-[#f44335] bg-white rounded-[6px]" style="font-family: 'Poppins', sans-serif;">
          {{.}}
        </span>
        {{end}}
      </div>

      <!-- Property Images with Overlay Stats -->
      {{if .P.HasImages}}
      {{$count := len .P.Gallery}}
      <div class="mb-6">
        {{if eq $count 1}}
        <div class="relative">
          <button type="button" class="relative block w-full h-[420px] rounded-[10px] overflow-hidden shadow-[0_4px_11.8px_rgba(0,0,0,0.25)]" data-gallery-index="0">
            <img src="{{index .P.Gallery 0}}" alt="{{.P.Title}}" class="w-full h-full object-cover" />
          </button>
          <!-- Stats Overlay -->
          <div class="absolute bottom-4 left-4 right-4 bg-[#e4e4e4] rounded-[5px] p-4 flex flex-wrap gap-6">
            {{if .P.Bedrooms}}
            <div class="flex items-center gap-2 text-[22px] font-normal leading-[26.4px] text-[#535353]" style="font-family: 'Poppins', sans-serif;">
              <img src="/assets/icons/bedroom.svg" alt="Bedrooms" class="w-6 h-6" />
              <span>{{.P.Bedrooms}}BHK Flat</span>
            </div>
            {{end}}
            {{if .P.Bathrooms}}
            <div class="flex items-center gap-2 text-[22px] font-normal leading-[26.4px] text-[#535353]" style="font-family: 'Poppins', sans-serif;">
              <img src="/assets/icons/bathroom.svg" alt="Bathrooms" class="w-6 h-6" />
              <span>{{.P.Bathrooms}}</span>
            </div>
            {{end}}
            {{if .P.Area}}
            <div class="flex items-center gap-2 text-[22px] font-normal leading-[26.4px] text-[#535353]" style="font-family: 'Poppins', sans-serif;">
              <img src="/assets/icons/area.svg" alt="Area" class="w-6 h-6" />
              <span>{{.P.Area}} sq ft</span>
            </div>
            {{end}}
            {{if .P.Parking}}
            <div class="flex items-center gap-2 text-[22px] font-normal leading-[26.4px] text-[#535353]" style="font-family: 'Poppins', sans-serif;">
              <img src="/assets/icons/parking.svg" alt="Parking" class="w-6 h-6" />
              <span>Yes</span>
            </div>
            {{end}}
          </div>
        </div>
        {{else if eq $count 2}}
        <div class="grid grid-cols-3 gap-4">
          <div class="col-span-2 relative">
            <button type="button" class="block w-full h-[420px] rounded-[10px] overflow-hidden shadow-[0_4px_11.8px_rgba(0,0,0,0.25)]" data-gallery-index="0">
              <img src="{{index .P.Gallery 0}}" alt="{{.P.Title}}" class="w-full h-full object-cover" />
            </button>
            <!-- Stats Overlay -->
            <div class="absolute bottom-4 left-4 right-4 bg-[#e4e4e4] rounded-[5px] p-4 flex flex-wrap gap-6">
              {{if .P.Bedrooms}}
              <div class="flex items-center gap-2 text-[22px] font-normal leading-[26.4px] text-[#535353]" style="font-family: 'Poppins', sans-serif;">
                <img src="/assets/icons/bedroom.svg" alt="Bedrooms" class="w-6 h-6" />
                <span>{{.P.Bedrooms}}BHK Flat</span>
              </div>
              {{end}}
              {{if .P.Bathrooms}}
              <div class="flex items-center gap-2 text-[22px] font-normal leading-[26.4px] text-[#535353]" style="font-family: 'Poppins', sans-serif;">
                <img src="/assets/icons/bathroom.svg" alt="Bathrooms" class="w-6 h-6" />
                <span>{{.P.Bathrooms}}</span>
              </div>
              {{end}}
              {{if .P.Area}}
              <div class="flex items-center gap-2 text-[22px] font-normal leading-[26.4px] text-[#535353]" style="font-family: 'Poppins', sans-serif;">
                <img src="/assets/icons/area.svg" alt="Area" class="w-6 h-6" />
                <span>{{.P.Area}} sq ft</span>
              </div>
              {{end}}
              {{if .P.Parking}}
              <div class="flex items-center gap-2 text-[22px] font-normal leading-[26.4px] text-[#535353]" style="font-family: 'Poppins', sans-serif;">
                <img src="/assets/icons/parking.svg" alt="Parking" class="w-6 h-6" />
                <span>Yes</span>
              </div>
              {{end}}
            </div>
          </div>
          <button type="button" class="col-span-1 h-[420px] rounded-[10px] overflow-hidden shadow-[0_4px_11.8px_rgba(0,0,0,0.25)]" data-gallery-index="1">
            <img src="{{index .P.Gallery 1}}" alt="{{.P.Title}}" class="w-full h-full object-cover" />
          </button>
        </div>
        {{else}}
        <div class="grid grid-cols-3 gap-4">
          <div class="col-span-2 relative">
            <button type="button" class="block w-full h-[420px] rounded-[10px] overflow-hidden shadow-[0_4px_11.8px_rgba(0,0,0,0.25)]" data-gallery-index="0">
              <img src="{{index .P.Gallery 0}}" alt="{{.P.Title}}" class="w-full h-full object-cover" />
            </button>
            <!-- Stats Overlay -->
            <div class="absolute bottom-4 left-4 right-4 bg-[#e4e4e4] rounded-[5px] p-4 flex flex-wrap gap-6">
              {{if .P.Bedrooms}}
              <div class="flex items-center gap-2 text-[22px] font-normal leading-[26.4px] text-[#535353]" style="font-family: 'Poppins', sans-serif;">
                <img src="/assets/icons/bedroom.svg" alt="Bedrooms" class="w-6 h-6" />
                <span>{{.P.Bedrooms}}BHK Flat</span>
              </div>
              {{end}}
              {{if .P.Bathrooms}}
              <div class="flex items-center gap-2 text-[22px] font-normal leading-[26.4px] text-[#535353]" style="font-family: 'Poppins', sans-serif;">
                <img src="/assets/icons/bathroom.svg" alt="Bathrooms" class="w-6 h-6" />
                <span>{{.P.Bathrooms}}</span>
              </div>
              {{end}}
              {{if .P.Area}}
              <div class="flex items-center gap-2 text-[22px] font-normal leading-[26.4px] text-[#535353]" style="font-family: 'Poppins', sans-serif;">
                <img src="/assets/icons/area.svg" alt="Area" class="w-6 h-6" />
                <span>{{.P.Area}} sq ft</span>
              </div>
              {{end}}
              {{if .P.Parking}}
              <div class="flex items-center gap-2 text-[22px] font-normal leading-[26.4px] text-[#535353]" style="font-family: 'Poppins', sans-serif;">
                <img src="/assets/icons/parking.svg" alt="Parking" class="w-6 h-6" />
                <span>Yes</span>
              </div>
              {{end}}
            </div>
          </div>
          <div class="grid grid-rows-2 gap-4">
            <button type="button" class="h-[200px] rounded-[10px] overflow-hidden shadow-[0_4px_11.8px_rgba(0,0,0,0.25)]" data-gallery-index="1">
              <img src="{{index .P.Gallery 1}}" alt="{{.P.Title}}" class="w-full h-full object-cover" />
            </button>
            <button type="button" class="relative h-[200px] rounded-[10px] overflow-hidden shadow-[0_4px_11.8px_rgba(0,0,0,0.25)]" data-gallery-index="2">
              <img src="{{index .P.Gallery 2}}" alt="{{.P.Title}}" class="w-full h-full object-cover" />
              {{if gt $count 3}}
              <div class="absolute inset-0 bg-black/50 flex items-center justify-center">
                <span class="text-white text-[92px] font-normal" style="font-family: 'Poppins', sans-serif;">+{{sub $count 3}}</span>
              </div>
              {{end}}
            </button>
          </div>
        </div>
        {{end}}
      </div>
      {{end}}

      <!-- Amenities -->
      <div class="bg-[#dadada] rounded-[5px] p-4 mb-6">
        <div class="flex flex-wrap gap-x-6 gap-y-3">
          <div class="flex items-center gap-2 text-[22px] font-normal leading-[26.4px] text-[#535353]" style="font-family: 'Poppins', sans-serif;">
            <img src="/assets/icons/check-circle.svg" alt="Amenity" class="w-6 h-6" />
            <span>Gas Supply</span>
          </div>
          <div class="flex items-center gap-2 text-[22px] font-normal leading-[26.4px] text-[#535353]" style="font-family: 'Poppins', sans-serif;">
            <img src="/assets/icons/check-circle.svg" alt="Amenity" class="w-6 h-6" />
            <span>Boundary Wall</span>
          </div>
          <div class="flex items-center gap-2 text-[22px] font-normal leading-[26.4px] text-[#535353]" style="font-family: 'Poppins', sans-serif;">
            <img src="/assets/icons/check-circle.svg" alt="Amenity" class="w-6 h-6" />
            <span>Kitchen Cabinet</span>
          </div>
          <div class="flex items-center gap-2 text-[22px] font-normal leading-[26.4px] text-[#535353]" style="font-family: 'Poppins', sans-serif;">
            <img src="/assets/icons/check-circle.svg" alt="Amenity" class="w-6 h-6" />
            <span>Power Backup</span>
          </div>
          <div class="flex items-center gap-2 text-[22px] font-normal leading-[26.4px] text-[#535353]" style="font-family: 'Poppins', sans-serif;">
            <img src="/assets/icons/check-circle.svg" alt="Amenity" class="w-6 h-6" />
            <span>Parking</span>
          </div>
          <div class="flex items-center gap-2 text-[22px] font-normal leading-[26.4px] text-[#535353]" style="font-family: 'Poppins', sans-serif;">
            <img src="/assets/icons/check-circle.svg" alt="Amenity" class="w-6 h-6" />
            <span>Lift</span>
          </div>
          <div class="flex items-center gap-2 text-[22px] font-normal leading-[26.4px] text-[#535353]" style="font-family: 'Poppins', sans-serif;">
            <img src="/assets/icons/check-circle.svg" alt="Amenity" class="w-6 h-6" />
            <span>Servant Room</span>
          </div>
          <div class="flex items-center gap-2 text-[22px] font-normal leading-[26.4px] text-[#535353]" style="font-family: 'Poppins', sans-serif;">
            <img src="/assets/icons/check-circle.svg" alt="Amenity" class="w-6 h-6" />
            <span>Furnished</span>
          </div>
        </div>
      </div>

      <!-- Description Section (Full Width) -->
      <div class="bg-[#f3f3f3] rounded-[10px] shadow-[0_3px_5px_rgba(0,0,0,0.15)] p-6 mb-6">
        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3 mb-4">
          <h2 class="text-[34px] font-medium text-[#383838]" style="font-family: 'Poppins', sans-serif;">Description</h2>
          <div class="flex items-center gap-4 bg-[#d9d9d9] rounded-[5px] px-4 py-2">
            <div class="flex items-center gap-2">
              <img src="/assets/icons/calendar.svg" alt="Year" class="w-[30px] h-[30px]" />
              <span class="text-[22px] font-medium leading-[26.4px] text-[#737373]" style="font-family: 'Poppins', sans-serif;">2023</span>
            </div>
            <div class="w-px h-11 border-l border-[#9d9d9d]"></div>
            <div class="flex items-center gap-2">
              <img src="/assets/icons/date.svg" alt="Date" class="w-[29px] h-[29px]" />
              <span class="text-[22px] font-medium leading-[26.4px] text-[#737373]" style="font-family: 'Poppins', sans-serif;">Jan 12, 2025</span>
            </div>
          </div>
        </div>

        <div class="border-t border-[#a3a3a3] pt-4 space-y-4">
          <h3 class="text-[24px] font-medium leading-[26.4px] text-[#272727]" style="font-family: 'Poppins', sans-serif;">
            Modern 3BHK Apartment with 4 Bathrooms | 1450 sq ft | 1 Parking
          </h3>
          <p class="text-[22px] font-medium leading-[26.4px] text-[#7d7d7d]" style="font-family: 'Poppins', sans-serif;">
            House 12, Road 5, Block C, Bashundhara, Dhaka
          </p>
          <div class="bg-white rounded-[5px] p-4">
            <p class="text-[22px] font-normal leading-[39px] text-[#4c4c4c]" style="font-family: 'Poppins', sans-serif;">
              Step into this spacious and thoughtfully planned 3-bedroom apartment, ideal for families seeking comfort, convenience, and style. Spanning 1450 square feet, this home features three generously sized bedrooms, each designed to ensure privacy and natural light. The four well-appointed bathrooms, including attached ones, offer added ease for busy households.
            </p>
          </div>
        </div>
      </div>

      <!-- Required Documents and Contact Form (Side by Side) -->
      <div class="grid lg:grid-cols-[1fr,2fr] gap-6">
        <!-- Required Documents -->
        <div class="bg-[#f3f3f3] rounded-[10px] shadow-[0_4px_6.9px_rgba(0,0,0,0.10)] p-6">
          <h2 class="text-[34px] font-medium text-[#383838] mb-4" style="font-family: 'Poppins', sans-serif;">Required Documents</h2>
          <div class="border-t border-[#aeaeae] pt-4 space-y-6">
            <div class="flex items-center gap-3">
              <img src="/assets/icons/check-circle.svg" alt="Check" class="w-6 h-6 flex-shrink-0" />
              <span class="text-[22px] font-normal leading-[26.4px] text-[#535353]" style="font-family: 'Poppins', sans-serif;">NID Copy</span>
            </div>
            <div class="flex items-center gap-3">
              <img src="/assets/icons/check-circle.svg" alt="Check" class="w-6 h-6 flex-shrink-0" />
              <span class="text-[22px] font-normal leading-[26.4px] text-[#535353]" style="font-family: 'Poppins', sans-serif;">Employment Letter</span>
            </div>
            <div class="flex items-center gap-3">
              <img src="/assets/icons/check-circle.svg" alt="Check" class="w-6 h-6 flex-shrink-0" />
              <span class="text-[22px] font-normal leading-[26.4px] text-[#535353]" style="font-family: 'Poppins', sans-serif;">Security Deposit Agreement</span>
            </div>
          </div>
        </div>

        <!-- Contact Form -->
        <div class="bg-[#f3f3f3] rounded-[10px] shadow-[0_4px_6.9px_rgba(0,0,0,0.10)] p-6">
          <h2 class="text-[34px] font-medium text-[#383838] mb-4" style="font-family: 'Poppins', sans-serif;">Contact Dhaka Home about this property</h2>
          <div class="border-t border-[#aeaeae] pt-4">
            <form action="/lead" method="post" class="space-y-6">
              <div>
                <label class="text-[16px] font-normal text-[#535353] mb-2 block" style="font-family: 'Poppins', sans-serif;">Name</label>
                <input 
                  type="text" 
                  name="name"
                  placeholder=""
                  class="w-full border-b border-[#535353] bg-transparent pb-2 focus:outline-none focus:border-[#f44335] text-[#3b3b3b] text-[16px]" 
                  style="font-family: 'Poppins', sans-serif;"
                />
              </div>
              <div>
                <label class="text-[16px] font-normal text-[#535353] mb-2 block" style="font-family: 'Poppins', sans-serif;">Phone</label>
                <input 
                  type="tel" 
                  name="phone"
                  placeholder=""
                  class="w-full border-b border-[#535353] bg-transparent pb-2 focus:outline-none focus:border-[#f44335] text-[#3b3b3b] text-[16px]" 
                  style="font-family: 'Poppins', sans-serif;"
                />
              </div>
              <div>
                <label class="text-[16px] font-normal text-[#535353] mb-2 block" style="font-family: 'Poppins', sans-serif;">Message</label>
                <input 
                  type="text" 
                  name="message"
                  placeholder=""
                  class="w-full border-b border-[#535353] bg-transparent pb-2 focus:outline-none focus:border-[#f44335] text-[#3b3b3b] text-[16px]" 
                  style="font-family: 'Poppins', sans-serif;"
                />
              </div>
              <input type="hidden" name="propertyId" value="{{.P.ID}}" />
              <div class="flex flex-col sm:flex-row gap-3 pt-2">
                <button 
                  type="button"
                  class="flex items-center justify-center gap-2 rounded-[5px] border border-[#f44335] px-6 py-3 hover:bg-[#f44335] hover:text-white transition-colors group"
                >
                  <img src="/assets/icons/phone-call.svg" alt="Call" class="w-7 h-7" />
                  <span class="text-[22px] font-medium leading-[28px] text-[#f44335] group-hover:text-white" style="font-family: 'Poppins', sans-serif;">Call</span>
                </button>
                <button 
                  type="submit"
                  class="bg-[#f44335] text-white text-[24px] font-medium leading-[28px] px-6 py-3 rounded-[5px] hover:bg-[#d63a2e] transition-colors"
                  style="font-family: 'Poppins', sans-serif;"
                >
                  Send E-mail
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Similar Listings Section -->
  <section class="max-w-[85rem] mx-auto px-4 pb-20">
    <h2 class="text-[40px] font-medium leading-[51.6px] text-[#383838] mb-8" style="font-family: 'Poppins', sans-serif;">Similar Listings</h2>
    
    {{if gt (len .Similar.Items) 0}}
    <div class="space-y-5">
      {{range .Similar.Items}}
      {{template "partials/property-card.html" .}}
      {{end}}
    </div>
    {{else}}
    <div class="text-center text-[#7d7d7d] py-10">
      No similar listings available right now.
    </div>
    {{end}}
  </section>
</div>

{{if .P.HasImages}}
<!-- Lightbox -->
<div id="gallery-lightbox" class="fixed inset-0 bg-black/80 z-50 hidden items-center justify-center px-4">
  <button type="button" class="absolute top-6 right-6 text-white text-2xl" data-lightbox-close>&times;</button>
  <button type="button" class="absolute left-4 md:left-10 text-white text-3xl font-semibold" data-lightbox-prev aria-label="Previous photo">&#10094;</button>
  <img id="lightbox-image" src="" alt="Gallery" class="max-h-[80vh] max-w-[90vw] object-contain rounded-[12px] shadow-[0_10px_25px_rgba(0,0,0,0.4)]" />
  <button type="button" class="absolute right-4 md:right-10 text-white text-3xl font-semibold" data-lightbox-next aria-label="Next photo">&#10095;</button>
</div>

<script>
  (function() {
    const galleryImages = [{{range $i, $img := .P.Gallery}}{{if $i}},{{end}}{{printf "%q" $img}}{{end}}];
    const lightbox = document.getElementById('gallery-lightbox');
    if (!lightbox || galleryImages.length === 0) return;

    const imgEl = document.getElementById('lightbox-image');
    const closeBtn = lightbox.querySelector('[data-lightbox-close]');
    const prevBtn = lightbox.querySelector('[data-lightbox-prev]');
    const nextBtn = lightbox.querySelector('[data-lightbox-next]');
    const triggers = document.querySelectorAll('[data-gallery-index]');
    let currentIndex = 0;

    function show(index) {
      if (index < 0 || index >= galleryImages.length) return;
      currentIndex = index;
      imgEl.src = galleryImages[currentIndex];
      lightbox.classList.remove('hidden');
      lightbox.classList.add('flex');
    }

    function hide() {
      lightbox.classList.add('hidden');
      lightbox.classList.remove('flex');
    }

    function next() {
      const nextIndex = (currentIndex + 1) % galleryImages.length;
      show(nextIndex);
    }

    function prev() {
      const prevIndex = (currentIndex - 1 + galleryImages.length) % galleryImages.length;
      show(prevIndex);
    }

    triggers.forEach((btn) => {
      btn.addEventListener('click', () => {
        const idx = Number(btn.getAttribute('data-gallery-index') || 0);
        show(idx);
      });
    });

    closeBtn.addEventListener('click', hide);
    nextBtn.addEventListener('click', next);
    prevBtn.addEventListener('click', prev);

    lightbox.addEventListener('click', (e) => {
      if (e.target === lightbox) hide();
    });
    document.addEventListener('keydown', (e) => {
      if (lightbox.classList.contains('hidden')) return;
      if (e.key === 'Escape') hide();
      if (e.key === 'ArrowRight') next();
      if (e.key === 'ArrowLeft') prev();
    });
  })();
</script>
{{end}}
{{end}}

{{define "pages/property.html"}}{{template "layouts/base.html" .}}{{end}}